# Lab 02 "Hello, World!" with VS Code Debugging**

**1. Introduction & Goal:**

Welcome to Rust! The traditional first step in learning any new language is printing "Hello, world!". This lab guides you through creating that simple program, but more importantly, it shows you how to set up Visual Studio Code (VS Code) for a smooth Rust development experience, including using its powerful integrated debugger. Debugging is a crucial skill for understanding how your code executes and for finding pesky bugs.

**Primary Learning Objective:** To set up a basic Rust development environment in VS Code and learn the fundamental workflow of writing, running, and debugging a simple Rust program.

**Concrete Outcomes:** By the end of this lab, you will be able to:

*   Set up VS Code with the necessary extensions for Rust development.
*   Create a new Rust project using Cargo.
*   Compile and run a basic Rust program from the VS Code integrated terminal.
*   Set breakpoints in your code.
*   Launch the VS Code debugger for your Rust program.
*   Step through your code using the debugger.

**2. Scenario:**

Imagine you're starting a brand new Rust project. Before diving into complex logic, you need to ensure your tools are working correctly. Can you compile? Can you run? Can you *see* what the code is doing step-by-step? Running a "Hello, World!" and stepping through it with a debugger is the perfect way to confirm your setup is solid.

*Why VS Code and Rust?* VS Code is a popular, free, and powerful code editor. When combined with the `rust-analyzer` extension, it provides excellent code completion, error highlighting, and navigation for Rust. Adding a debugger extension allows you to inspect your program's execution flow directly within the editor, significantly boosting productivity and understanding compared to just using `println!` statements everywhere.

**3. Prerequisites:**

*   **Software:**
    *   **Rust Toolchain:** Installed (includes `rustc` compiler and `cargo` build tool/package manager). We'll use Rust `edition = "2021"`. Tested with `rustc 1.70` or later.
    *   **Visual Studio Code:** Installed.
    *   **Internet Connection:** Needed to download VS Code extensions.
*   **Knowledge:**
    *   Basic computer literacy (using a file explorer, opening applications).
    *   How to open a terminal or command prompt on your operating system.
    *   How to install extensions within VS Code.
    *   No prior Rust programming knowledge is required!
*   **Setup Verification:** Before starting, open your terminal (not in VS Code yet) and run these commands to ensure Rust is installed:
    ```bash
    rustc --version
    cargo --version
    ```
    You should see version numbers printed for both. Make sure VS Code is also installed.

**4. Setup Instructions:**

1.  **Create a New Rust Project:**
    Open your terminal or command prompt, navigate to a directory where you want to keep your projects, and run:
    ```bash
    cargo new hello_vscode --edition 2021
    ```
    This command creates a new directory named `hello_vscode` containing a basic Rust project structure. The `--edition 2021` flag ensures we're using the latest Rust edition features.

2.  **Open the Project in VS Code:**
    *   Navigate into the newly created project directory:
        ```bash
        cd hello_vscode
        ```
    *   Open the directory in VS Code. You can often do this from the terminal:
        ```bash
        code .
        ```
        (The `.` means "the current directory"). Alternatively, open VS Code manually and use `File > Open Folder...` to select the `hello_vscode` directory.
    *   If prompted, trust the authors of the files in this folder.

3.  **Install Recommended VS Code Extensions:**
    *   Go to the Extensions view in VS Code (click the square icon on the left sidebar, or press `Ctrl+Shift+X`).
    *   Search for and install `rust-analyzer`. This is the primary extension providing language support (autocompletion, error checking, go-to-definition, etc.).
    *   Search for and install a debugger extension. The recommended cross-platform choice is `CodeLLDB`. If you are on Windows, `C/C++` from Microsoft also provides debugging capabilities (often used alongside `rust-analyzer`), but `CodeLLDB` generally offers a smoother experience specifically for Rust. For this lab, we'll assume you installed `CodeLLDB`.
    *   After installing, you might need to restart VS Code or wait a moment for `rust-analyzer` to download necessary components and analyze your project (you might see status updates in the bottom bar).

**5. Lab Steps (Iterative Development):**

*   **Step 1: Examine the Initial Code**
    *   **Task:** Look at the simple "Hello, world!" program automatically generated by Cargo.
    *   **Code Implementation:** Open the `src/main.rs` file in VS Code. It should contain:
        ```rust
        fn main() {
            println!("Hello, world!");
        }
        ```
    *   **Explanation:**
        *   `fn main()`: This defines the main function, which is the entry point of every executable Rust program. When you run your program, the code inside this function executes first.
        *   `println!("Hello, world!")`: This line uses the `println!` macro (macros look like functions but end with `!`) to print the text "Hello, world!" to the console, followed by a newline.
        *   Notice how `rust-analyzer` might provide syntax highlighting and potentially underlines or helpful hints.
    *   **Verification:** Simply observe the code. Make sure `rust-analyzer` seems active (no major error notifications at the bottom, syntax highlighting is present).

*   **Step 2: Running the Program (Terminal)**
    *   **Task:** Compile and run your program using Cargo directly within VS Code's integrated terminal.
    *   **Code Implementation:**
        *   Open the integrated terminal in VS Code (use the menu `Terminal > New Terminal` or the shortcut `Ctrl+` \` (backtick)).
        *   In the terminal panel that appears (ensure its current directory is your `hello_vscode` project root), type the following command and press Enter:
        ```bash
        cargo run
        ```
    *   **Explanation:**
        *   `cargo run`: This command tells Cargo to first compile your code (if it hasn't been compiled already or if changes were made) into an executable file (placed in the `target/debug/` directory), and then immediately run that executable.
    *   **Verification:** You should see output similar to this in the terminal:
        ```
           Compiling hello_vscode v0.1.0 (/path/to/your/project/hello_vscode)
            Finished dev [unoptimized + debuginfo] target(s) in X.Ys
             Running `target/debug/hello_vscode`
        Hello, world!
        ```
        The key is seeing the "Hello, world!" output line.

*   **Step 3: Setting a Breakpoint**
    *   **Task:** Tell the debugger where you want it to pause execution.
    *   **Code Implementation:** In the `src/main.rs` editor window, move your mouse cursor to the left of the line number for the `println!("Hello, world!");` line. Click in the gutter area.
    *   **Explanation:** A red dot should appear. This is a **breakpoint**. When you run the program under the debugger, it will pause execution *just before* executing the line with the breakpoint.
    *   **Verification:** Ensure the red dot is visible next to the line number.

*   **Step 4: Starting the Debugger**
    *   **Task:** Launch your program with the debugger attached.
    *   **Code Implementation:**
        *   Go to the "Run and Debug" view by clicking the icon that looks like a bug with a play symbol on the left sidebar (or press `Ctrl+Shift+D`).
        *   Click the green "Run and Debug" button at the top of the view.
        *   VS Code might ask you to select a debugger environment or configuration. Choose the one related to Rust or `CodeLLDB` (it often autodetects correctly). If it prompts "Select Launch Configuration", choose the one like "Debug hello_vscode (binary)".
        *   Alternatively, you can often just press `F5` as a shortcut to start debugging with the default configuration.
    *   **Explanation:** This action compiles your code (if necessary) and then starts the program under the control of the debugger (`CodeLLDB` in our case). The debugger will automatically stop at the first breakpoint it encounters.
    *   **Verification:**
        *   The program execution should pause. The line with your breakpoint (`println!...`) should now be highlighted (often in yellow), with a yellow arrow pointing to it.
        *   A "Debug toolbar" should appear somewhere (usually near the top of the VS Code window) with buttons like Continue (Play), Step Over, Step Into, Step Out, Restart, and Stop.
        *   The "Run and Debug" view sidebar will now show information about the call stack and local variables (though we don't have interesting variables yet).

*   **Step 5: Stepping Through Code**
    *   **Task:** Execute the current line of code and move to the next one.
    *   **Code Implementation:** On the Debug toolbar, click the "Step Over" button (it usually looks like a curved arrow jumping over a dot, or press `F10`).
    *   **Explanation:**
        *   "Step Over" executes the highlighted line of code. Since the highlighted line was `println!`, executing it causes "Hello, world!" to be printed.
        *   Execution then moves to the next logical point (in this simple case, the end of the `main` function).
        *   Crucially, when debugging, output from `println!` often appears in the **DEBUG CONSOLE** tab within VS Code's terminal panel, not necessarily in the regular "TERMINAL" tab you used for `cargo run`. Check the "DEBUG CONSOLE".
    *   **Verification:**
        *   The yellow highlight moves past the `println!` line (likely disappears as the function is ending).
        *   The text "Hello, world!" should appear in the "DEBUG CONSOLE" tab.

*   **Step 6: Stopping the Debugger**
    *   **Task:** End the debugging session.
    *   **Code Implementation:** Click the "Stop" button (the red square) on the Debug toolbar.
    *   **Explanation:** This immediately terminates the program being debugged.
    *   **Verification:** The debugging session ends, the yellow highlight disappears, and the Debug toolbar vanishes. You are returned to normal editing mode.

**6. Running the Application / Testing:**

You've already done this in the steps!

*   To simply compile and run without debugging: Use `cargo run` in the integrated terminal (`Ctrl+` \`). Output appears in the "TERMINAL" tab.
*   To run with the debugger: Set breakpoints, then use the "Run and Debug" view (Ctrl+Shift+D) or press `F5`. Output appears in the "DEBUG CONSOLE" tab.

**7. Key Concepts Review:**

*   **`cargo new`**: Creates a new Rust project with a standard directory structure and `Cargo.toml` file.
*   **`cargo run`**: Compiles and runs your executable target.
*   **`src/main.rs`**: The default location for the main source code file of a binary crate.
*   **`fn main()`**: The entry point function for Rust binaries.
*   **`println!`**: A macro to print text to the console.
*   **VS Code Extensions:**
    *   `rust-analyzer`: Provides core Rust language intelligence (completion, errors, etc.).
    *   `CodeLLDB` (or similar): Enables debugging support within VS Code.
*   **Breakpoint:** A marker that tells the debugger to pause execution at a specific line. Set by clicking in the gutter.
*   **Debugging Session:** Running your program under the control of a debugger (started via F5 or Run and Debug view).
*   **Debug Toolbar:** Provides controls like Step Over (F10), Continue (F5), Stop (Shift+F5).
*   **Step Over (F10):** Executes the current line and pauses at the next line in the current function.
*   **DEBUG CONSOLE:** The panel where program output (`println!`) usually appears during a debugging session.

**8. (Optional) Challenges / Next Steps:**

1.  **Add More Output:** Add a second `println!("Learning Rust!");` line in `main.rs`. Set breakpoints on *both* `println!` lines. Start the debugger and use "Step Over" (F10) twice to see each line execute and print its output to the Debug Console.
2.  **Inspect a Variable:** Modify `main.rs` like this:
    ```rust
    fn main() {
        let message = "Debugging is cool!"; // Add this line
        println!("{}", message);          // Modify this line
    }
    ```
    Set a breakpoint on the `println!` line. Start debugging (F5). When execution pauses, look at the "VARIABLES" section in the "Run and Debug" sidebar. You should see the `message` variable and its value `"Debugging is cool!"`. Then "Step Over" (F10) to see it print.
3.  **Explore:** Read Chapter 1 and 2 of The Rust Programming Language book ("The Book"): [https://doc.rust-lang.org/book/](https://doc.rust-lang.org/book/)
4.  **VS Code Docs:** Look at the VS Code documentation for Rust: [https://code.visualstudio.com/docs/languages/rust](https://code.visualstudio.com/docs/languages/rust)

**9. (Optional) Troubleshooting:**

*   **`rust-analyzer` errors or not working:**
    *   Make sure it's installed and enabled in VS Code Extensions view.
    *   Check the `rust-analyzer: Status` by opening the Command Palette (`Ctrl+Shift+P`) and typing it.
    *   Ensure your base Rust installation (`rustc --version`) is working.
    *   Try restarting VS Code (`Developer: Reload Window` from Command Palette or just close/reopen).
*   **Debugger fails to start / "Launch configuration" issues:**
    *   Ensure `CodeLLDB` (or `C/C++` on Windows) extension is installed and enabled.
    *   Make sure `cargo build` runs successfully in the terminal first.
    *   Try explicitly clicking the gear icon in the "Run and Debug" view to create a `launch.json` file – VS Code might offer a default Rust template.
    *   Rarely, path or environment variable issues might interfere. Check your Rust installation paths.
*   **Breakpoint not being hit:**
    *   Is the red dot definitely visible on an executable line of code (not a blank line or comment)?
    *   Did you start the debugger (F5 / Run and Debug view), or did you just run `cargo run`? Breakpoints only work when the debugger is active.
    *   Is the code definitely reaching the line with the breakpoint?

**10. Conclusion:**

Congratulations! You've successfully set up VS Code for Rust development, created your first project, run it, and crucially, stepped through it using the debugger. While "Hello, world!" is simple, the workflow you learned here – edit, run, debug – is fundamental. Mastering the debugger is key to understanding more complex Rust code later on. Keep experimenting!

**11. (Optional) Final Solution Code:**

The final code for `src/main.rs` (without the optional challenges) is simply:

```rust
// Final Code for src/main.rs
fn main() {
    println!("Hello, world!");
}
```

**12. Check Questions (To Test Understanding):**

1.  What is the main purpose of the `rust-analyzer` extension in VS Code for Rust development?
2.  What command do you use in the VS Code integrated terminal to compile *and* run your Rust program directly, without debugging?
3.  How do you visually set a breakpoint in the VS Code editor, and what effect does it have when you start debugging?
4.  During a debugging session started with F5 or the "Run and Debug" view, where does the output from `println!` typically appear?
5.  When paused at a breakpoint, what does the "Step Over" (F10) action do in the debugger?

**13. Detailed Answers to Check Questions:**

1.  **`rust-analyzer` purpose:** The `rust-analyzer` extension provides essential language support for Rust within VS Code. Its main purposes include real-time error checking and diagnostics (underlining problems), code completion (intellisense), code navigation (go to definition, find references), refactoring tools, and formatting suggestions, making the coding process much faster and more reliable.
2.  **Compile and Run command:** To compile and run your Rust program directly without debugging, you use the command `cargo run` in the integrated terminal. Cargo handles the compilation step (if needed) and then executes the resulting binary.
3.  **Setting a breakpoint:** You set a breakpoint by clicking in the gutter area to the left of the line number in the editor. A red dot appears. When you start the program with the debugger attached (e.g., using F5), the debugger will pause the program's execution *just before* the line with the breakpoint is executed, allowing you to inspect the program's state.
4.  **`println!` output during debug:** During a debugging session, output from `println!` typically appears in the **DEBUG CONSOLE** tab within VS Code's lower panel (where the terminal usually resides). This is separate from the regular "TERMINAL" tab used by `cargo run`.
5.  **"Step Over" (F10) action:** When the debugger is paused on a line, pressing "Step Over" (F10) executes that single line of code. If the line contains a function call, it executes the entire function without stepping into its internal code, and then pauses again at the *next* line in the current function. It's used to move through code line-by-line at the current level of abstraction.